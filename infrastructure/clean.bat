@echo off
REM ============================================================================
REM Test Service Infrastructure - Clean/Reset (Windows)
REM ============================================================================

echo.
echo ??????????????????????????????????????????????????????????????????
echo ?         Test Service - Clean Infrastructure                   ?
echo ??????????????????????????????????????????????????????????????????
echo.

echo ??  WARNING: This will remove all containers, volumes, and data!
echo.
choice /C YN /M "Are you sure you want to continue?"
if errorlevel 2 goto :cancel

echo.
echo Stopping and removing containers...
docker-compose -f infrastructure\docker-compose.yml down -v

if %errorlevel% equ 0 (
    echo ? Containers and volumes removed
) else (
    echo ? Failed to clean infrastructure
    goto :end
)

echo.
echo Removing unused Docker resources...
docker system prune -f

echo.
echo ? Infrastructure cleaned successfully!
echo.
echo To start fresh:
echo   infrastructure\start.bat
echo.
goto :end

:cancel
echo.
echo ? Operation cancelled
echo.

:end
pause
